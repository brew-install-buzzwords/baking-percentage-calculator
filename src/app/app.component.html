<div class="container">
  <div class="form">

    <h1 class="text-center">Bread Baking Percentages Calculator</h1>

    <mat-divider></mat-divider>

    <mat-accordion>
      <mat-expansion-panel [expanded]="panelOpenState" (opened)="panelOpenState = true"
      (closed)="panelOpenState = false" class="description">
        <mat-expansion-panel-header>
          <mat-panel-title>
            About this tool
          </mat-panel-title>
        </mat-expansion-panel-header>
        <p>
          Bakers percentages are a common way of expressing the ratio of ingredients to flour for breads and other baked goods. They provide a helpful shorthand for expressing 
          the proportions of a recipe that can be easily adjusted to different batch sizes.
        </p>
        <p>
          To calculate the bakers percentage of any ingredient, simply divide the weight of that ingredient (in grams) by the weight of the flour (in grams).
        </p>

        <mat-action-row>
          <button mat-button color="primary" (click)="panelOpenState = false">Close</button>
        </mat-action-row>
      </mat-expansion-panel>
    </mat-accordion>
    

    <mat-divider></mat-divider>

    <div class="form-section">
      <div *ngFor="let flour of model.flours; index as i" class="form-row" [ngClass]="{'form-row-alt': i % 2 === 1}">
        <mat-form-field class="form-row-item">
          <mat-label>Name</mat-label>
          <input matInput placeholder="Flour" [value]="flour.name" type="text">
        </mat-form-field>
        
        <mat-form-field class="form-row-item">
          <mat-label>Weight</mat-label>
          <input matInput placeholder="1000" [(ngModel)]="flour.value" type="number" (change)="onFlourChange($event.target.value, flour.id)">
          <span matSuffix>g</span>
        </mat-form-field>

        <button mat-button color="warn" (click)="deleteFlour(flour.id)" class="form-row-item" [disabled]="model.flours.length === 1">Delete</button>
      </div>

      <button mat-raised-button color="primary" (click)="addNewFlour()" class="add-item-button">Add new flour</button>
    </div>


    <mat-divider></mat-divider>

    <div class="form-section">
      <div *ngFor="let ingredient of model.ingredients; index as i" class="form-row" [ngClass]="{'form-row-alt': i % 2 === 1}">
        <mat-form-field class="base-padding form-row-item">
          <mat-label>Name</mat-label>
          <input matInput placeholder="Ingredient" [value]="ingredient.name" type="text">
        </mat-form-field>
        
        <mat-form-field class="base-padding form-row-item">
          <mat-label>Weight</mat-label>
          <input matInput placeholder="1" [(ngModel)]="ingredient.value" type="number" (change)="onIngredientValueChange($event.target.value, ingredient.id)">
          <span matSuffix>g</span>
        </mat-form-field>
  
        <mat-form-field class="base-padding form-row-item">
          <mat-label>Percentage</mat-label>
          <input matInput placeholder="1" [(ngModel)]="ingredient.percentage" type="number" (change)="onIngredientPercentageChange($event.target.value, ingredient.id)" min=1>
          <span matSuffix>%</span>
        </mat-form-field>

        <button mat-button color="warn" (click)="deleteIngredient(ingredient.id)" [disabled]="model.ingredients.length === 1">Delete</button>

      </div>

      <button mat-raised-button color="primary" (click)="addNewIngredient()" class="add-item-button">Add new ingredient</button>
    </div>

    <mat-divider></mat-divider>

    <div class="form-section">
      <div class="results-row">
        <mat-form-field class="form-row-item">
          <mat-label>Total Weight</mat-label>
          <input matInput placeholder="1000" [value]="model.totalWeight" type="number" disabled=true>
          <span matSuffix>g</span>
        </mat-form-field>
        <span>&nbsp;&#247;&nbsp;</span>
        <mat-form-field class="form-row-item">
          <mat-label>Number of loaves</mat-label>
          <input matInput (change)="onLoafChange($event)" [(ngModel)]="this.model.numberOfLoaves" type="number">
        </mat-form-field>
        <span>&nbsp;=&nbsp;{{gramsPerLoaf}}g&nbsp;per&nbsp;loaf</span>
      </div>

    </div>

    <mat-action-row class="command-row">
      <button mat-raised-button color="primary" (click)="adjustRecipe(2)">Double</button>
      <button mat-raised-button color="primary" (click)="adjustRecipe(0.5)">Halve</button>
      <button mat-raised-button color="warn" (click)="reset()">Reset</button>
    </mat-action-row>

    <app-printer [model]="model" [title]="title" [showPrinter]="showPrinter"></app-printer>
  </div>
</div>
